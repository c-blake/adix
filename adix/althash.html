<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>adix/althash</title>

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- CSS -->
<link rel="stylesheet" type="text/css" href="../nimdoc.out.css?v=2.0.17">

<!-- JS -->
<script type="text/javascript" src="../dochack.js?v=2.0.17"></script>
</head>
<body>
  <div class="document" id="documentId">
    <div class="container">
      <h1 class="title">adix/althash</h1>
      <div class="row">
  <div class="three columns">
    <div class="theme-select-wrapper">
      <label for="theme-select">Theme:&nbsp;</label>
      <select id="theme-select" onchange="setTheme(this.value)">
        <option value="auto">ðŸŒ— Match OS</option>
        <option value="dark">ðŸŒ‘ Dark</option>
        <option value="light">ðŸŒ• Light</option>
      </select>
    </div>
    <div id="global-links">
      <ul class="simple">
        <li><a id="indexLink" href="../theindex.html">Index</a></li>
      </ul>
    </div>
    <div id="searchInputDiv">
      Search: <input type="search" id="searchInput" onkeyup="search()"/>
    </div>
    <div>
      Group by:
      <select onchange="groupBy(this.value)">
        <option value="section">Section</option>
        <option value="type">Type</option>
      </select>
    </div>
    <ul class="simple simple-toc" id="toc-list">
  <li>
  <a class="reference reference-toplevel" href="#6" id="56">Imports</a>
</li>
<li>
  <details open>
    <summary><a class="reference reference-toplevel" href="#8" id="58">Vars</a></summary>
    <ul class="simple simple-toc-section">
      <li><a class="reference" href="#getSalt" title="getSalt = vmaddrSalt">getSalt</a></li>

    </ul>
  </details>
</li>
<li>
  <details open>
    <summary><a class="reference reference-toplevel" href="#12" id="62">Procs</a></summary>
    <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">hash
  <li><a class="reference" href="#hash%2CHash%2CHash" title="hash(hsh, salt: Hash): Hash">hash(hsh, salt: Hash): Hash</a></li>

</ul>
<ul class="simple nested-toc-section">hashDegski
  <li><a class="reference" href="#hashDegski%2CT" title="hashDegski[T: Ordinal | enum](x: T): Hash">hashDegski[T: Ordinal | enum](x: T): Hash</a></li>

</ul>
<ul class="simple nested-toc-section">hashIdentity
  <li><a class="reference" href="#hashIdentity%2CT" title="hashIdentity[T: Ordinal | enum](x: T): Hash">hashIdentity[T: Ordinal | enum](x: T): Hash</a></li>

</ul>
<ul class="simple nested-toc-section">hashMoreMur
  <li><a class="reference" href="#hashMoreMur%2CT" title="hashMoreMur[T: Ordinal | enum](x: T): Hash">hashMoreMur[T: Ordinal | enum](x: T): Hash</a></li>

</ul>
<ul class="simple nested-toc-section">hashNASAM
  <li><a class="reference" href="#hashNASAM%2CT" title="hashNASAM[T: Ordinal | enum](x: T): Hash">hashNASAM[T: Ordinal | enum](x: T): Hash</a></li>

</ul>
<ul class="simple nested-toc-section">hashRevFib
  <li><a class="reference" href="#hashRevFib" title="hashRevFib(x: int32 | uint32): Hash">hashRevFib(x: int32 | uint32): Hash</a></li>
<li><a class="reference" href="#hashRevFib_2" title="hashRevFib(x: int64 | uint64): Hash">hashRevFib(x: int64 | uint64): Hash</a></li>
<li><a class="reference" href="#hashRevFib%2Cuint" title="hashRevFib(x: uint): Hash">hashRevFib(x: uint): Hash</a></li>

</ul>
<ul class="simple nested-toc-section">hashRoMu1
  <li><a class="reference" href="#hashRoMu1" title="hashRoMu1(x: SomeOrdinal | Hash): Hash">hashRoMu1(x: SomeOrdinal | Hash): Hash</a></li>
<li><a class="reference" href="#hashRoMu1%2Cuint" title="hashRoMu1(x: uint): Hash">hashRoMu1(x: uint): Hash</a></li>

</ul>
<ul class="simple nested-toc-section">hashRoMu2
  <li><a class="reference" href="#hashRoMu2" title="hashRoMu2(x: SomeOrdinal | Hash): Hash">hashRoMu2(x: SomeOrdinal | Hash): Hash</a></li>

</ul>
<ul class="simple nested-toc-section">hashSplit64
  <li><a class="reference" href="#hashSplit64%2CT" title="hashSplit64[T: Ordinal | enum](x: T): Hash">hashSplit64[T: Ordinal | enum](x: T): Hash</a></li>

</ul>
<ul class="simple nested-toc-section">hashSplitMix
  <li><a class="reference" href="#hashSplitMix%2CT" title="hashSplitMix[T: Ordinal | enum](x: T): Hash">hashSplitMix[T: Ordinal | enum](x: T): Hash</a></li>

</ul>
<ul class="simple nested-toc-section">hashWangYi1
  <li><a class="reference" href="#hashWangYi1%2CT" title="hashWangYi1[T: Ordinal | enum](x: T): Hash">hashWangYi1[T: Ordinal | enum](x: T): Hash</a></li>

</ul>
<ul class="simple nested-toc-section">hashWY0
  <li><a class="reference" href="#hashWY0%2CT" title="hashWY0[T: Ordinal | enum](x: T): Hash">hashWY0[T: Ordinal | enum](x: T): Hash</a></li>

</ul>
<ul class="simple nested-toc-section">normalized
  <li><a class="reference" href="#normalized%2CopenArray%5BT%5D" title="normalized[T](x: openArray[T]): seq[float]">normalized[T](x: openArray[T]): seq[float]</a></li>

</ul>
<ul class="simple nested-toc-section">raiseNotFound
  <li><a class="reference" href="#raiseNotFound%2CK" title="raiseNotFound[K](key: K)">raiseNotFound[K](key: K)</a></li>

</ul>
<ul class="simple nested-toc-section">secureSalt
  <li><a class="reference" href="#secureSalt%2Cpointer" title="secureSalt(x: pointer): Hash">secureSalt(x: pointer): Hash</a></li>

</ul>
<ul class="simple nested-toc-section">vmaddrSalt
  <li><a class="reference" href="#vmaddrSalt%2Cpointer" title="vmaddrSalt(x: pointer): Hash">vmaddrSalt(x: pointer): Hash</a></li>

</ul>
<ul class="simple nested-toc-section">zeroSalt
  <li><a class="reference" href="#zeroSalt%2Cpointer" title="zeroSalt(x: pointer): Hash">zeroSalt(x: pointer): Hash</a></li>

</ul>

    </ul>
  </details>
</li>
<li>
  <details open>
    <summary><a class="reference reference-toplevel" href="#18" id="68">Templates</a></summary>
    <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">dbg
  <li><a class="reference" href="#dbg.t" title="dbg(x)">dbg(x)</a></li>

</ul>

    </ul>
  </details>
</li>

</ul>

  </div>
  <div class="nine columns" id="content">
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L1" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L1" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

    <div id="tocRoot"></div>
    
    <p class="module-desc"><p>This module provides several alternative hashes to the Nim stdlib targeting high entropy in low order bits for <tt class="docutils literal"><span class="pre"><span class="Keyword">and</span> <span class="Identifier">mask</span></span></tt> conversion to a table index. Activate via e.g., <tt class="docutils literal"><span class="pre"><span class="Keyword">proc</span> <span class="Identifier">hash</span><span class="Punctuation">(</span><span class="Identifier">x</span><span class="Punctuation">:</span> <span class="Identifier">K</span><span class="Punctuation">)</span><span class="Punctuation">:</span> <span class="Identifier">Hash</span> <span class="Punctuation">{</span><span class="Operator">.</span><span class="Identifier">inline</span><span class="Operator">.</span><span class="Punctuation">}</span> <span class="Operator">=</span> <span class="Identifier">hashRoMu1</span><span class="Punctuation">(</span><span class="Identifier">x</span><span class="Punctuation">)</span></span></tt>, where <tt class="docutils literal"><span class="pre"><span class="Identifier">K</span></span></tt> is your integer key type.</p>
<p>The fastest hash used here is a likely the multiply &amp; rotate hash (lately called a &quot;Fibonacci hash&quot;, after Knuth's golden ratio fascination.  Knuth immediately, in context, shows it works for any irrational number and then computer arithmetic is finite anyway).  This propagates entropy in key bits to the double-width product in a Pascal's Binomial Triangle sort of pattern. Middle bits have the most key related entropy (there is even a PRNG method called &quot;middle square&quot; based on this pattern).  More specifically, consider the product of a pair of 2 digit decimal numbers: <tt class="docutils literal"><span class="pre"><span class="Punctuation">(</span><span class="Identifier">a1</span><span class="Operator">*</span><span class="DecNumber">10</span><span class="Operator">+</span><span class="Identifier">a0</span><span class="Punctuation">)</span><span class="Operator">*</span><span class="Punctuation">(</span><span class="Identifier">b1</span><span class="Operator">*</span><span class="DecNumber">10</span><span class="Operator">+</span><span class="Identifier">b0</span><span class="Punctuation">)</span> <span class="Operator">=</span> <span class="Identifier">a1</span><span class="Operator">*</span><span class="Identifier">b1</span><span class="Operator">*</span><span class="DecNumber">100</span> <span class="Operator">+</span> <span class="Punctuation">(</span><span class="Identifier">a1</span><span class="Operator">*</span><span class="Identifier">b0</span><span class="Operator">+</span><span class="Identifier">b0</span><span class="Operator">*</span><span class="Identifier">a1</span><span class="Punctuation">)</span><span class="Operator">*</span><span class="DecNumber">10</span> <span class="Operator">+</span> <span class="Identifier">a0</span><span class="Operator">*</span><span class="Identifier">b0</span></span></tt>. This shows the &quot;triangle&quot; kind of pattern that makes the mixing strongest in the middle.</p>
<p>The full product is easily accessed for half CPU register width and narrower numbers.  For the widest integer type, C/backend arithmetic rules only give the modulus|lower order bits of said product (x86/amd64 does make the upper word available in another register).  hashRoMu1 takes the simple portable way out and discards half of key entropy, just rotating down the more well mixed bits (bit reversal might be better, though expensive compared to rotr). Reducing hash codes to table address via <tt class="docutils literal"><span class="pre"><span class="Keyword">shr</span></span></tt> is another way out.  Getting high order avalanche is more natural than the low order avalanche needed for <tt class="docutils literal"><span class="pre"><span class="Keyword">and</span> <span class="Identifier">mask</span></span></tt>, both may be <a class="reference external" href="https://burtleburtle.net/bob/hash/integer.html's">https://burtleburtle.net/bob/hash/integer.html's</a> &quot;half avalanche&quot;.  Anyway, rotating is portably fast (often 1 cycle latency, 1-per cycle tput for an immediate constant number of bits).  Bit reversal is not so slow using a fully unrolled loop and 16 entry nibble lookup table. Different hashes will perform more/less well on different data.  So, we just provide a few here, and one is based upon highly non-linear bit reversal.</p>
<p>A stronger hash is <tt class="docutils literal"><span class="pre"><span class="Identifier">hashWangYi1</span></span></tt> which passes SMHasher's entropy tests, but &quot;funnels&quot; 64 inputs into about 62-bits of output entropy.  It is still the default Hash-rehasher since it is fast &amp; tables with 2^62 entries are rare. WangYi1's primitive is the xor of the high &amp; low parts of a double-width product of a salt with a key.  The xor blends well-mixed low order bits of the high output product word with less well-mixed low order bits of the low output product word, yielding &quot;mostly level&quot; mixing across all bits of the hash.  WangYi1 takes two rounds of such mixing to achieve avalanche.  It may be possible to &quot;nearly pass&quot; in only one round.  <tt class="docutils literal"><span class="pre"><span class="Identifier">hashWY0</span></span></tt> is one attempt at that, but the salt may need to be re-optimized to have any hope of doing well on SMHasher.  This hash became the default <tt class="docutils literal"><span class="pre"><span class="Identifier">hash</span><span class="Punctuation">(</span><span class="Identifier">int</span><span class="Punctuation">)</span></span></tt> in Nim stdlib.</p>
<p>There is a motley selection of other hashes here.  The strongest fast hash is Pelle Evensen's bijective (64-bits -&gt; 64-bits) <tt class="docutils literal"><span class="pre"><span class="Identifier">hashNASAM</span></span></tt>.  It's 2-3x slower than WangYi1 on some CPU architectures, but has no known statistical flaws.</p>
<p>Incidentally, most &quot;fast in GB/s&quot; hashes are far too slow for just one int. Even assessing them so is misleading for lookup tables.  You want <tt class="docutils literal"><span class="pre"><span class="Identifier">time</span> <span class="Operator">=~</span> <span class="Identifier">a</span> <span class="Operator">+</span> <span class="Identifier">b</span><span class="Operator">*</span><span class="Identifier">nBytes</span></span></tt> where a &amp; b maybe come from line regressions.  <tt class="docutils literal"><span class="pre"><span class="DecNumber">1</span><span class="Operator">/</span><span class="Identifier">b</span></span></tt> alone says too little, especially for integer keys where <tt class="docutils literal"><span class="pre"><span class="Identifier">a</span></span></tt> dominates.  Short string hashes or <tt class="docutils literal"><span class="pre"><span class="Identifier">a</span></span></tt> alone can similarly mislead.  TLDR, want &gt;=2 &quot;summary numbers&quot; not one &amp; whole curves are best.</p>
</p>
    <div class="section" id="6">
  <h1><a class="toc-backref" href="#6">Imports</a></h1>
  <dl class="item">
    <a class="reference external" href="bitop.html">bitop</a>
  </dl>
</div>
<div class="section" id="8">
  <h1><a class="toc-backref" href="#8">Vars</a></h1>
  <dl class="item">
    <div id="getSalt">
  <dt><pre><a href="althash.html#getSalt"><span class="Identifier">getSalt</span></a> <span class="Other">=</span> <span class="Identifier">vmaddrSalt</span></pre></dt>
  <dd>
    
    
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L234" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L234" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

  </dl>
</div>
<div class="section" id="12">
  <h1><a class="toc-backref" href="#12">Procs</a></h1>
  <dl class="item">
    <div id="hash-procs-all">
  <div id="hash,Hash,Hash">
  <dt><pre><span class="Keyword">proc</span> <a href="#hash%2CHash%2CHash"><span class="Identifier">hash</span></a><span class="Other">(</span><span class="Identifier">hsh</span><span class="Other">,</span> <span class="Identifier">salt</span><span class="Other">:</span> <span class="Identifier">Hash</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span><span class="Other">,</span> <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L243" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L243" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="hashDegski-procs-all">
  <div id="hashDegski,T">
  <dt><pre><span class="Keyword">proc</span> <a href="#hashDegski%2CT"><span class="Identifier">hashDegski</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">:</span> <span class="Identifier">Ordinal</span> <span class="Operator">|</span> <span class="Keyword">enum</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span>.}</pre></dt>
  <dd>
    
    <a class="reference external" href="https://gist.github.com/degski/6e2069d6035ae04d5d6f64981c995ec2">https://gist.github.com/degski/6e2069d6035ae04d5d6f64981c995ec2</a>
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L204" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L204" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="hashIdentity-procs-all">
  <div id="hashIdentity,T">
  <dt><pre><span class="Keyword">proc</span> <a href="#hashIdentity%2CT"><span class="Identifier">hashIdentity</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">:</span> <span class="Identifier">Ordinal</span> <span class="Operator">|</span> <span class="Keyword">enum</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span>.}</pre></dt>
  <dd>
    
    
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L184" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L184" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="hashMoreMur-procs-all">
  <div id="hashMoreMur,T">
  <dt><pre><span class="Keyword">proc</span> <a href="#hashMoreMur%2CT"><span class="Identifier">hashMoreMur</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">:</span> <span class="Identifier">Ordinal</span> <span class="Operator">|</span> <span class="Keyword">enum</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span>.}</pre></dt>
  <dd>
    
    This is from <a class="reference external" href="https://github.com/tommyettinger">https://github.com/tommyettinger</a>
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L162" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L162" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="hashNASAM-procs-all">
  <div id="hashNASAM,T">
  <dt><pre><span class="Keyword">proc</span> <a href="#hashNASAM%2CT"><span class="Identifier">hashNASAM</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">:</span> <span class="Identifier">Ordinal</span> <span class="Operator">|</span> <span class="Keyword">enum</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span>.}</pre></dt>
  <dd>
    
    
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L172" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L172" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="hashRevFib-procs-all">
  <div id="hashRevFib">
  <dt><pre><span class="Keyword">proc</span> <a href="#hashRevFib"><span class="Identifier">hashRevFib</span></a><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">int32</span> <span class="Operator">|</span> <span class="Identifier">uint32</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span>.}</pre></dt>
  <dd>
    
    
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L214" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L214" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>
<div id="hashRevFib_2">
  <dt><pre><span class="Keyword">proc</span> <a href="#hashRevFib_2"><span class="Identifier">hashRevFib</span></a><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">int64</span> <span class="Operator">|</span> <span class="Identifier">uint64</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span>.}</pre></dt>
  <dd>
    
    
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L217" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L217" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>
<div id="hashRevFib,uint">
  <dt><pre><span class="Keyword">proc</span> <a href="#hashRevFib%2Cuint"><span class="Identifier">hashRevFib</span></a><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">uint</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span><span class="Other">,</span> <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L238" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L238" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="hashRoMu1-procs-all">
  <div id="hashRoMu1">
  <dt><pre><span class="Keyword">proc</span> <a href="#hashRoMu1"><span class="Identifier">hashRoMu1</span></a><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">SomeOrdinal</span> <span class="Operator">|</span> <span class="Identifier">Hash</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span>.}</pre></dt>
  <dd>
    
    1-hop of Romul-DuoJr using x as seed
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L58" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L58" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>
<div id="hashRoMu1,uint">
  <dt><pre><span class="Keyword">proc</span> <a href="#hashRoMu1%2Cuint"><span class="Identifier">hashRoMu1</span></a><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">uint</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span><span class="Other">,</span> <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L237" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L237" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="hashRoMu2-procs-all">
  <div id="hashRoMu2">
  <dt><pre><span class="Keyword">proc</span> <a href="#hashRoMu2"><span class="Identifier">hashRoMu2</span></a><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">SomeOrdinal</span> <span class="Operator">|</span> <span class="Identifier">Hash</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span>.}</pre></dt>
  <dd>
    
    Just the cross terms of 128-bit whole product
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L62" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L62" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="hashSplit64-procs-all">
  <div id="hashSplit64,T">
  <dt><pre><span class="Keyword">proc</span> <a href="#hashSplit64%2CT"><span class="Identifier">hashSplit64</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">:</span> <span class="Identifier">Ordinal</span> <span class="Operator">|</span> <span class="Keyword">enum</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span>.}</pre></dt>
  <dd>
    
    <a class="reference external" href="https://nullprogram.com/blog/2018/07/31/">https://nullprogram.com/blog/2018/07/31/</a>
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L194" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L194" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="hashSplitMix-procs-all">
  <div id="hashSplitMix,T">
  <dt><pre><span class="Keyword">proc</span> <a href="#hashSplitMix%2CT"><span class="Identifier">hashSplitMix</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">:</span> <span class="Identifier">Ordinal</span> <span class="Operator">|</span> <span class="Keyword">enum</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span>.}</pre></dt>
  <dd>
    
    This is one hop of a PRNG.  For more information on the PRNG part see <a class="reference external" href="http://docs.oracle.com/javase/8/docs/api/java/util/SplittableRandom.html">http://docs.oracle.com/javase/8/docs/api/java/util/SplittableRandom.html</a>
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L186" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L186" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="hashWangYi1-procs-all">
  <div id="hashWangYi1,T">
  <dt><pre><span class="Keyword">proc</span> <a href="#hashWangYi1%2CT"><span class="Identifier">hashWangYi1</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">:</span> <span class="Identifier">Ordinal</span> <span class="Operator">|</span> <span class="Keyword">enum</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span>.}</pre></dt>
  <dd>
    
    Wang Yi's hash_v1 for 8B int.  <a class="reference external" href="https://github.com/rurban/smhasher">https://github.com/rurban/smhasher</a> has more details.  This passed all scrambling tests in Spring 2019 and is simple. NOTE: It's ok to define <tt class="docutils literal"><span class="pre">proc(x:int16): Hash=hashWangYi1(cast[Hash](x))</span></tt>.
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L125" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L125" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="hashWY0-procs-all">
  <div id="hashWY0,T">
  <dt><pre><span class="Keyword">proc</span> <a href="#hashWY0%2CT"><span class="Identifier">hashWY0</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">:</span> <span class="Identifier">Ordinal</span> <span class="Operator">|</span> <span class="Keyword">enum</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span>.}</pre></dt>
  <dd>
    
    A slightly simplified/early version of Wang Yi's hash for 8B ints. Faster, but less scrambling.  Definitely has some easy weak spots.
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L154" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L154" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="normalized-procs-all">
  <div id="normalized,openArray[T]">
  <dt><pre><span class="Keyword">proc</span> <a href="#normalized%2CopenArray%5BT%5D"><span class="Identifier">normalized</span></a><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">openArray</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><span class="Identifier">float</span><span class="Other">]</span></pre></dt>
  <dd>
    
    
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L257" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L257" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="raiseNotFound-procs-all">
  <div id="raiseNotFound,K">
  <dt><pre><span class="Keyword">proc</span> <a href="#raiseNotFound%2CK"><span class="Identifier">raiseNotFound</span></a><span class="Other">[</span><span class="Identifier">K</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">key</span><span class="Other">:</span> <span class="Identifier">K</span><span class="Other">)</span></pre></dt>
  <dd>
    
    
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L251" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L251" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="secureSalt-procs-all">
  <div id="secureSalt,pointer">
  <dt><pre><span class="Keyword">proc</span> <a href="#secureSalt%2Cpointer"><span class="Identifier">secureSalt</span></a><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">pointer</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span><span class="Other">,</span> <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OSError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
                                    <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L221" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L221" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="vmaddrSalt-procs-all">
  <div id="vmaddrSalt,pointer">
  <dt><pre><span class="Keyword">proc</span> <a href="#vmaddrSalt%2Cpointer"><span class="Identifier">vmaddrSalt</span></a><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">pointer</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span><span class="Other">,</span> <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L225" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L225" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>
<div id="zeroSalt-procs-all">
  <div id="zeroSalt,pointer">
  <dt><pre><span class="Keyword">proc</span> <a href="#zeroSalt%2Cpointer"><span class="Identifier">zeroSalt</span></a><span class="Other">(</span><span class="Identifier">x</span><span class="Other">:</span> <span class="Identifier">pointer</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">Hash</span> {.<span class="Identifier">inline</span><span class="Other">,</span> <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L229" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L229" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>

  </dl>
</div>
<div class="section" id="18">
  <h1><a class="toc-backref" href="#18">Templates</a></h1>
  <dl class="item">
    <div id="dbg-templates-all">
  <div id="dbg.t">
  <dt><pre><span class="Keyword">template</span> <a href="#dbg.t"><span class="Identifier">dbg</span></a><span class="Other">(</span><span class="Identifier">x</span><span class="Other">)</span></pre></dt>
  <dd>
    
    
    <a href="https://github.com/c-blake/adix/tree/f5c4e63dae283b3dd5ea358c8fe920876a0cff14/adix/althash.nim#L248" class="link-seesrc" target="_blank">Source</a>&nbsp;&nbsp;
<a href="https://github.com/c-blake/adix/edit/master/adix/althash.nim#L248" class="link-seesrc" target="_blank" >Edit</a>&nbsp;&nbsp;

  </dd>
</div>

</div>

  </dl>
</div>

  </div>
</div>

      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br>
        <small style="color: var(--hint);">Made with Nim. Generated: 2025-10-17 12:12:24 UTC</small>
      </div>
    </div>
  </div>
  
  <!-- Google fonts -->
  <link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
  <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>
</body>
</html>
